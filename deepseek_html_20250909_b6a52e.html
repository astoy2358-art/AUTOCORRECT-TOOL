<!-- templates/index.html (enhanced version) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Autocorrect Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-blue-600">AI-Powered Autocorrect Tool</h1>
            <p class="text-gray-600 mt-2">Correct spelling errors using advanced NLP techniques</p>
        </header>
        
        <div class="grid md:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4">Input Text</h2>
                <textarea 
                    id="inputText" 
                    class="w-full h-64 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                    placeholder="Type or paste your text here..."
                >Ths is an exmple of text with som spelling erors.</textarea>
                <div class="mt-4 flex justify-between items-center">
                    <button 
                        id="correctBtn" 
                        class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md transition duration-200 flex items-center"
                    >
                        Correct Text
                    </button>
                    <div id="loading" class="hidden mr-4">
                        <div class="loading"></div>
                        <span class="ml-2 text-gray-600">Processing...</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4">Corrected Text</h2>
                <div 
                    id="outputText" 
                    class="w-full h-64 p-3 border border-gray-300 rounded-md bg-gray-50 overflow-auto"
                ></div>
                <div class="mt-4 flex justify-end">
                    <button 
                        id="copyBtn" 
                        class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-md transition duration-200"
                    >
                        Copy to Clipboard
                    </button>
                </div>
            </div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">How It Works</h2>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700">1. Text Analysis</h3>
                    <p class="text-sm mt-2">Your text is analyzed word by word using natural language processing techniques.</p>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-green-700">2. Candidate Generation</h3>
                    <p class="text-sm mt-2">For each potentially misspelled word, similar candidates are generated using edit distance.</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-purple-700">3. Statistical Ranking</h3>
                    <p class="text-sm mt-2">Candidates are ranked by similarity and frequency to select the most likely correction.</p>
                </div>
            </div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Word Frequency Analysis</h2>
            <p class="text-gray-600 mb-4">This chart shows the top 20 most frequent words in our dataset:</p>
            <div class="flex justify-center">
                <img src="{{ url_for('static', filename='chart.png') }}" alt="Word Frequency Chart" class="max-w-full h-auto">
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const inputText = document.getElementById('inputText');
            const outputText = document.getElementById('outputText');
            const correctBtn = document.getElementById('correctBtn');
            const copyBtn = document.getElementById('copyBtn');
            const loading = document.getElementById('loading');
            
            // Function to highlight differences between two texts
            function highlightDifferences(original, corrected) {
                const originalWords = original.split(/\b/);
                const correctedWords = corrected.split(/\b/);
                let result = '';
                let i = 0, j = 0;
                
                while (i < originalWords.length && j < correctedWords.length) {
                    if (originalWords[i] === correctedWords[j]) {
                        result += originalWords[i];
                        i++;
                        j++;
                    } else {
                        // Find where the next match occurs
                        let k = 1;
                        while (i + k < originalWords.length && 
                               j + k < correctedWords.length && 
                               originalWords[i + k] !== correctedWords[j + k]) {
                            k++;
                        }
                        
                        // Highlight the changed word
                        result += `<span class="word-diff">${correctedWords[j]}</span>`;
                        j++;
                        i++;
                    }
                }
                
                // Add any remaining words
                while (j < correctedWords.length) {
                    result += `<span class="word-diff">${correctedWords[j]}</span>`;
                    j++;
                }
                
                return result;
            }
            
            correctBtn.addEventListener('click', async function() {
                const text = inputText.value.trim();
                
                if (!text) {
                    alert('Please enter some text to correct.');
                    return;
                }
                
                // Show loading indicator
                loading.classList.remove('hidden');
                correctBtn.disabled = true;
                
                try {
                    const response = await fetch('/correct', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ text: text })
                    });
                    
                    const data = await response.json();
                    
                    if (data.error) {
                        alert('Error: ' + data.error);
                    } else {
                        // Highlight differences between original and corrected text
                        const highlighted = highlightDifferences(text, data.corrected_text);
                        outputText.innerHTML = highlighted;
                    }
                } catch (error) {
                    alert('An error occurred: ' + error.message);
                } finally {
                    // Hide loading indicator
                    loading.classList.add('hidden');
                    correctBtn.disabled = false;
                }
            });
            
            copyBtn.addEventListener('click', function() {
                const text = outputText.textContent;
                
                if (!text) {
                    alert('No corrected text to copy.');
                    return;
                }
                
                navigator.clipboard.writeText(text)
                    .then(() => {
                        // Show a temporary success message
                        const originalText = copyBtn.textContent;
                        copyBtn.textContent = 'Copied!';
                        copyBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                        copyBtn.classList.add('bg-green-500');
                        
                        setTimeout(() => {
                            copyBtn.textContent = originalText;
                            copyBtn.classList.remove('bg-green-500');
                            copyBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                        }, 2000);
                    })
                    .catch(err => {
                        alert('Failed to copy text: ' + err);
                    });
            });
        });
    </script>
</body>
</html>